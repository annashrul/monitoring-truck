<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- Boostrap 4 CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <!-- Style -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <!-- Script -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
    <style>
        *{
            font-family: 'Poppins', sans-serif;
        }
        .bold {
            font-weight: bold !important;
        }
        .wrapper-card{
            margin-right: 10px;
            border:2px solid #EEEEEE;
            padding:25px;
            text-align: center;
            border-radius: 10px;
            color: grey;
            font-weight: bold;
            cursor: pointer;
        }
        .wrapper-card:hover{
            border-color: red !important;
        }
        .select2-container--default .select2-selection--single{
            padding:25px;
            height: auto;
            margin-right: 10px;
            font-weight: bold;
            position: relative;
            border: 2px solid #EEEEEE !important;
            border-radius: 10px !important;
            align-content: center !important;
        }
        span.select2-selection--single[aria-expanded=true] {
            border-color: red !important;
        }
        .select2-selection--single:hover{
            border-color: red !important;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow b{
            border-style: none !important;
        }
        .js-example-basic-single{
            width: 100%;padding:20px
        }
        .select2-container--default .select2-selection--single .select2-selection__rendered {
            /*line-height: normal!important;*/
        }
        .select2-container .select2-selection--single .select2-selection__rendered {
            /*white-space: normal!important;*/
            color: grey !important;
        }
        .select2-container--default .select2-selection--single .select2-selection__placeholder{
            color: grey !important;
        }
        .select2-search__field:focus
        {border: 1px solid #3c8dbc !important;outline: none !important;}
        .select2-container--default .select2-search--dropdown .select2-search__field{
            border-bottom: 1px solid #EEEEEE !important;
            border-top: none !important;
            border-left: none !important;
            border-right: none !important;
            /*border-radius: 10px !important;*/
        }
        .select2-container--default .select2-search--dropdown:focus{
            border: 1px solid #EEEEEE !important;
            border-radius: 10px !important;
        }
        .select2-dropdown{
            border: 1px solid #EEEEEE !important;
            border-radius: 10px !important;
        }
        .select2-container--default .select2-results__option--highlighted.select2-results__option--selectable{
            background-color: white !important;
        }
        .input-custom{
            padding: 27px !important;
            height: auto !important;
            border: 2px solid #EEEEEE;
            border-radius: 10px;
            color: grey !important;
            font-weight: bold;
        }
        select.form-control{
            padding: 27px !important;
            height: auto !important;
            border: 2px solid #EEEEEE;
            border-radius: 10px;
            color: grey !important;
            font-weight: bold;
        }
        select:focus, .input-custom:focus{
            outline: none !important;
            border-color: red !important;
            box-shadow:none !important;

        }
        .input-custom-group{
            padding: 20px !important;
            height: auto !important;
            border: 2px solid #EEEEEE;
            border-radius: 10px;
            color: grey !important;
            font-weight: bold;
        }
        .input-custom-group>.form-control{
            border: none !important;
            text-align: center;
            color: grey !important;
            font-weight: bold;
        }
        .input-custom-group>.form-control:focus{
            outline: none !important;
            border-color: red !important;
            box-shadow:none !important;

        }
        button.btn-no-border{
            border: none !important;
        }
        button.btn-no-border:hover{
            border: none !important;
            background-color: transparent !important;
            color: grey !important;
            font-weight: bold;
        }
        button.btn-no-border:focus{
            border: none !important;
            background-color: transparent !important;
            color: grey !important;
            font-weight: bold;
            box-shadow:none !important;
        }
        .wrapper-card-weight{
            margin-left: 10px;
            border:2px solid #EEEEEE;
            padding:15px;
            text-align: right;
            border-radius: 10px;
            color: grey;
            font-weight: normal;
            background-color: #EEEEEE;
        }
        input[readonly]{
            background-color: transparent !important;
            cursor: not-allowed;
        }
        /**/
        /*.btn-outline-secondary:not(:disabled):not(.disabled).active, .btn-outline-secondary:not(:disabled):not(.disabled):active, .show>.btn-outline-secondary.dropdown-toggle{*/
            /*background-color: transparent !important;*/
            /*color: grey !important;*/
            /*font-weight: bold;*/
        /*}*/
        .btn-action-add-destinatoin{
            padding: 15px;
            border-radius: 10px;
            border-color: transparent;
            font-weight: bold;
            background-color: black;
            color: white;
        }
        .btn-action-add-destinatoin:hover{
            background-color: black;
            color: white;
        }
        .btn-action{
            padding: 15px;
            border-radius: 10px;
            border-color: transparent;
            font-weight: bold;
        }
        .btn-add{
            background-color: #EDF2FF;
            color: black;
        }
        .btn-del{
            background-color: #F7941E;
            color: white;
        }
        .btn-add:hover{
            background-color: #EDF2FF;
            color: black;
            border-color: #EDF2FF;
        }
        .btn-del:hover{
            background-color: #F7941E;
            color: white;
            border-color: #F7941E;

        }
        .select2-container--default .select2-results__option--selected {
            background-color: #ddd !important;
            color: red !important;
        }
        .select2-results__option {
            color: grey;
            font-weight: bold !important;
        }

        .select2-results__option--highlighted {
            color: red !important;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light"  style="padding-left:0;margin-left: 95px;margin-right: 95px;">
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link bold" href="#">
                    <img style="height:100px;width: 150px" src="https://bkk.smkn4kuningan.sch.id/storage/mitra/1628411658-pt-toyota-motor-manufacturing-indonesia.png" alt="">
                </a>
            </li>
        </ul>
        <ul class="navbar-nav">
            <li class="nav-item active" style="text-align: right">
                <a class="nav-link bold" href="#">Delivery Truck</a>
                <a class="nav-link" href="#">Sunday, 09-16-2022 07:11 AM</a>
            </li>
        </ul>
    </div>
</nav>
<hr style="padding-top: 0;margin-top: 0;border-width: 2px">
<div class="container">
    <div class="row">
        <div class="col-md-3 bold p-0">
            <i class="fa fa-truck" style="font-size: 30px;border: 2px solid #EEEEEE;border-radius: 100%;padding:10px;margin-right: 10px"></i>
            Detail Pemilihan Truck
        </div>
        <div class="col-md-12 p-0 bold mt-4">
            Pilih Jenis Truck
        </div>

        <div class="col-md-2 mt-4 wrapper-card">
            Truck Size S
        </div>
        <div class="col-md-2 mt-4 wrapper-card">
            Truck Size M
        </div>
        <div class="col-md-2 mt-4 wrapper-card">
            Truck Size L
        </div>
    </div>
</div>
<div class="container mt-4 p-0">
    <hr style="border-style: dashed;border-width: 1px;border-color: #eeeeee">
</div>
<div id="container-destination">

</div>
<div class="container">
    <div class="row">
        <div class="col-md-12 bold p-0">
            <button onclick="addDestination()" class="btn btn-outline-secondary btn-action-add-destinatoin"><i class="fa fa-plus"></i> TAMBAH DESTINASI</button>
        </div>
    </div>
</div>


</body>
</html>

<script>
    var noItems=1;
    var noDestination=1;

    var dataDest=[
        {
            id:1,
            detail:[{id:`${noDestination}-${noItems}`,qty:1,size:5}]
        }
    ];

    $(document).ready(function() {
        $('#address').select2({
            placeholder: 'masukkan alamat',
        });
        setTimeout(function(){
            templateDestination(1)
//            templateBox(1);
            getProvince();
        },100)
    });

    function addDestination(){
        noDestination=noDestination+1;
        dataDest.push({
            id:noDestination,
            detail:[{
                id:`${noDestination}-${noItems}`,qty:1,size:5
            }]
        })
        setTimeout(function(){
            templateDestination(noDestination);
        },100)
    }


    function addBox(item,dest){
        noItems = noItems+1;
        var idxItem=parseInt(item.split("_")[1],10);
        var idxDest=parseInt(dest.split("_")[1],10);
        var detail = dataDest[idxDest].detail;
        detail.push({id:`${noDestination}-${noItems}`,qty:1,size:5})
        setTimeout(function(){
            templateDestination();
        },100)
    }
    function delBox(item,dest){
        if(noItems>1){
            noItems = noItems-1;
            var idxItem=parseInt(item.split("_")[1],10);
            var idxDest=parseInt(dest.split("_")[1],10);
            var detail = dataDest[idxDest].detail;
            var newDetail = detail.filter(function(res){
                return res.id!==detail[idxItem-1].id
            })
            detail = newDetail;
            dataDest[idxDest].detail = detail;
            setTimeout(function(){
                templateDestination()
            },100)
        }

    }


    function minBoxItem(id,des){
        console.log(des)
        var attrId=$(`#${id}`);
        var getValInput=parseInt(attrId.val(),10);
        if(getValInput>1){
            getValInput=getValInput-1;
            attrId.val(getValInput);
            $(`#weight_${id.split("_")[1]}`).html(getValInput)
        }

    }
    function addBoxItem(item,dest){

//        var attrId=$(`#${id}`);
//        var getValInput=parseInt(attrId.val(),10)+1;
//        attrId.val(getValInput);
//        $(`#weight_${id.split("_")[1]}`).html(getValInput)
    }



    function templateDestination(){
        var html="";

        for(var i=0;i<dataDest.length;i++){
            console.log(dataDest[i].detail)
            var isCancel=false;
            if(i>0){
                isCancel=true
            }
            var htmlCancel='';
            htmlCancel=isCancel?'<div class="col-md-6" style="float:right;text-align: right;color:orange;cursor: pointer;">cancel destinasi</div>':'';
            console.log(htmlCancel)
            var htmlItem='';
            for(var x=0;x<dataDest[i].detail.length;x++){
                htmlItem+= '<div class="row wrap_'+i+'">\n' +
                    '                    <div class="col-md-3 mr-2 mt-4 p-0" style="">\n' +
                    '                        <select class="form-control" name="state">\n' +
                    '                            <option value="">Ukuran Box</option>\n' +
                    '                        </select>\n' +
                    '                    </div>\n' +
                    '                    <div class="col-md-3 mt-4 p-0" style="">\n' +
                    '                        <div class="input-group input-custom-group" >\n' +
                    '                            <button onclick="minBoxItem(\'item_'+x+'\',\'dest_'+i+'\')" class="btn btn-outline-secondary btn-no-border" type="button"><i class="fa fa-minus"></i></button>\n' +
                    '                            <input readonly value="'+dataDest[i].detail[x].qty+'" id="item_'+i+'_'+x+'" type="text" class="form-control" placeholder="Qty Box" aria-label="Recipient\'s username" aria-describedby="button-addon2">\n' +
                    '                            <button onclick="addBoxItem(\'item_'+x+'\',\'dest_'+i+'\')" class="btn btn-outline-secondary btn-no-border" type="button"><i class="fa fa-plus"></i></button>\n' +
                    '                        </div>\n' +
                    '                    </div>\n' +
                    '                    <div class="col-md-2 mt-4 wrapper-card-weight">\n' +
                    '                        Box Weight<br/><span style="font-weight: bold"><span id="item_weight_'+i+'_'+x+'">1</span> Kg</span>\n' +
                    '                    </div>\n' +
                    '                </div>';
            }
            html+= '<div class="container">\n' +
            '        <div class="row">\n' +
            '            <div class="col-md-12 bold p-0">\n' +
            '                <div class="row" style="vertical-align: middle;align-content: center;align-items: center">\n' +
            '                    <div class="col-md-6">\n' +
            '                        <i class="fa fa-sitemap" style="font-size: 30px;border: 2px solid #EEEEEE;border-radius: 100%;padding:10px;margin-right: 10px"></i>\n' +
            '                        Pemilihan Destinasi\n' +
            '                    </div>\n'+
                    htmlCancel+
            '                </div>\n' +
            '            </div>\n' +
            '            <div class="col-md-4 mt-4 p-0" style="">\n' +
            '                <select class="form-control" name="state" id="address">\n' +
            '                </select>\n' +
            '            </div>\n' +
            '            <div class="col-md-3 mt-4" style="">\n' +
            '                <select class="form-control" name="state" id="province" onchange="getCity($(this).val())">\n' +
            '                </select>\n' +
            '            </div>\n' +
            '            <div class="col-md-3 mt-4" style="">\n' +
            '                <select class="form-control" name="state" id="city">\n' +
            '                </select>\n' +
            '            </div>\n' +
            '            <div class="col-md-2 mt-4 p-0" style="">\n' +
            '                <input type="text" class="form-control input-custom" placeholder="masukkan kode pos">\n' +
            '            </div>\n' +
            '        </div>\n' +
            '        <div class="container mt-4">\n' +
            '            <div class="row" style="margin-left: 20px;padding-right: 20px;margin-bottom: 20px">\n' +
            '                <div class="col-md-12 bold p-0">\n' +
            '                    <i class="fa fa-cube" style="font-size: 30px;border: 2px solid #EEEEEE;border-radius: 100%;padding:10px;margin-right: 10px"></i>\n' +
            '                    Pemilihan Box\n' +
            '                </div>\n' +
            '                <div class="col-md-12">'+htmlItem+'</div>\n' +
            '                <div class="col-md-2 mr-3 p-0 mt-4">\n' +
            '                    <button onclick="addBox(\'item_'+x+'\',\'dest_'+i+'\')" class="btn btn-outline-secondary btn-block btn-action btn-add"><i class="fa fa-plus"></i> TAMBAH BOX</button>\n' +
            '                </div>\n' +
            '                <div class="col-md-2 p-0 mt-4">\n' +
            '                    <button onclick="delBox(\'item_'+x+'\',\'dest_'+i+'\')" class="btn btn-outline-secondary btn-block btn-action btn-del"><i class="fa fa-trash-o"></i> DELETE</button>\n' +
            '                </div>\n' +
            '            </div>\n' +
            '        </div>\n' +
            '    </div>\n' +
            '    <div class="container mt-4 p-0">\n' +
            '        <hr style="border-style: dashed;border-width: 1px;border-color: #eeeeee">\n' +
            '    </div>'
        }

        $("#container-destination").html(html)

    }




    function getProvince(){
        $.ajax({
            url:"http://www.emsifa.com/api-wilayah-indonesia/api/provinces.json",
            dataType:"JSON",
            type:"GET",
            success:function(res){
                var html="<option>pilih provinsi</option>";
                for(var i=0;i<res.length;i++){
                    html+='<option value="'+res[i].id+'" style="color: grey;">'+res[i].name+'</option>';
                }
                setTimeout(function(){
                    $("#province").html(html)
                },100)
            }
        });
    }
    function getCity(provinceId){
        dataCity = [];
        $.ajax({
            url:`http://www.emsifa.com/api-wilayah-indonesia/api/regencies/${provinceId}.json`,
            dataType:"JSON",
            type:"GET",
            success:function(res){
                var html="<option>pilih kota</option>";
                for(var i=0;i<res.length;i++){
                    html+='<option value="'+res[i].id+'" style="color: grey;">'+res[i].name+'</option>';
                }

                setTimeout(function(){
                    $("#city").html(html)
                },100)

            },
            error: function (xhr, status) {
                alert("error");

            }
        });

    }


</script>